
* PROGRAM NAME: PBP_IMPORT_PARTD_CMS.SAS;
* DESCRIPTION:  IMPORT THE INDIVIDUAL PBP TABLES AND MERGE TOGETHER;

LIBNAME PBP "&PBPDIR";  

DATA PBP_MRX;
  SET PBP.PBPMRX(KEEP=
  QID
  HPLAN
  MRX_DRUG_BEN_YN
  MRX_BENEFIT_TYPE
  MRX_ALT_DED_CHARGE
  MRX_ALT_DED_AMOUNT
  MRX_AE_CSTSHR_APPLY
  MRX_ALT_PRE_ICL_COST_SHARE
  MRX_ALT_GAP_COVG_YN
  MRX_ALT_DED_TYPE_YN
  MRX_ALT_NO_DED_TIER
  MRX_ALT_DED_TIER_CSTSHR_YN
  MRX_ALT_GEN_COINS_PCT
  MRX_ALT_GEN_COPAY_AMT
  MRX_ALT_GEN_CSTSHR_STRUCT
  MRX_FIRST_FILL
  MRX_TIER_FORM_EX
  MRX_TIER_FORM_EX_2_YN
  MRX_TIER_FORM_EX_2
  MRX_GEN_IRA_RSTD_COPAY_1M);
  IF PUT(HPLAN,$TYPEF.) NE 'NO';
RUN;

DATA PBP_MRX_TIER;
  SET PBP.PBPMRX_T(KEEP=
  QID
  HPLAN
  MRX_TIER_ID
  MRX_TIER_TYPE_ID
  MRX_TIER_CSTSHR_STRUCT_TYPE
  MRX_TIER_RSPFD_COPAY_1M
  MRX_TIER_RSTD_COPAY_1M
  MRX_TIER_RSSTD_COPAY_1M
  MRX_TIER_OONP_COPAY_1M
  MRX_TIER_RSPFD_COINS_1M
  MRX_TIER_RSTD_COINS_1M
  MRX_TIER_RSSTD_COINS_1M
  MRX_TIER_OONP_COINS_1M
  MRX_TIER_GAP_COST_SHARE
  MRX_TIER_INCLUDES
  MRX_TIER_IRA_RSTD_COPAY_1M
  MRX_TIER_IRA_RSPFD_COPAY_1M);
  IF PUT(HPLAN,$TYPEF.) NE 'NO';
RUN;