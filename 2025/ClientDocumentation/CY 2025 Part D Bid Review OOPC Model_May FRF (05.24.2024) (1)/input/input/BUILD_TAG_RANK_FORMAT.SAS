* PROGRAM NAME: BUILD_TAG_RANK_FORMAT.SAS;

LIBNAME IN "&INPUTDIR";

DATA FMT;
   SET IN.RXCUI_REFERENCE (KEEP = RXCUI TAG_ID) END=LAST;
   START=RXCUI;
   LABEL=TAG_ID;
   FMTNAME='TAGFMT';
   HLO=' ';
   OUTPUT FMT;
   IF LAST THEN DO;
     START=.;
     LABEL="N/A";
     HLO='O';
     OUTPUT FMT;
   END;
   KEEP START LABEL FMTNAME HLO;
RUN;

PROC FORMAT CNTLIN=FMT LIBRARY=LIBRARY;
RUN;

DATA FMTRANK;
   SET IN.RXCUI_REFERENCE (KEEP = RXCUI RANK) END=LAST;
   START=RXCUI;
   LABEL=RANK;
   FMTNAME='RANKFMT';
   HLO=' ';
   OUTPUT FMTRANK;
   IF LAST THEN DO;
     START=.;
     LABEL=.;
     HLO='O';
     OUTPUT FMTRANK;
   END;
   KEEP START LABEL FMTNAME HLO;
RUN;

PROC FORMAT CNTLIN=FMTRANK LIBRARY=LIBRARY;
RUN;

DATA FMTINS;
   SET IN.RXCUI_REFERENCE (KEEP = RXCUI INSULIN) END=LAST;
   START=RXCUI;
   LABEL=INSULIN;
   FMTNAME='INSFMT';
   HLO=' ';
   OUTPUT FMTINS;
   IF LAST THEN DO;
     START=.;
     LABEL=' ';
     HLO='O';
     OUTPUT FMTINS;
   END;
   KEEP START LABEL FMTNAME HLO;
RUN;

PROC FORMAT CNTLIN=FMTINS LIBRARY=LIBRARY;
RUN;
